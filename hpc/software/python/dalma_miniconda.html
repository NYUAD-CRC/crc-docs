

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Miniconda in Dalma &mdash; CRC Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="PyTorch in Dalma" href="dalma_pytorch.html" />
    <link rel="prev" title="Jupyter Notebook in Dalma" href="dalma_jupyter.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/crc-wordmark-light.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">HPC Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../hpc.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accounts/index.html">Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../system/index.html">System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../storage/index.html">Storage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#software-modules">Software Modules</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#dalma-miniconda">Dalma Miniconda</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Python Softwares in Dalma</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="dalma_jupyter.html">Jupyter Notebook in Dalma</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Miniconda in Dalma</a></li>
<li class="toctree-l4"><a class="reference internal" href="dalma_pytorch.html">PyTorch in Dalma</a></li>
<li class="toctree-l4"><a class="reference internal" href="dalma_tensorflow.html">TensorFlow (Keras) in Dalma</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#r-with-dalma-miniconda">R with Dalma Miniconda</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../jobs/index.html">Jobs Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../research/index.html">Research Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help/index.html">Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/index.html">Dalma Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dalma_load/index.html">Dalma Load</a></li>
</ul>
<p><span class="caption-text">RCS Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rcs/rcs.html">Research Computing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rcs/1001n.html">1001n Research Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rcs/kb/index.html">Knowledge Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rcs/data_science/index.html">Research Data Science Services</a></li>
</ul>
<p><span class="caption-text">Team</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../team.html">Center for Research Computing Team</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">CRC Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Software</a> &raquo;</li>
        
          <li><a href="index.html">Python Softwares in Dalma</a> &raquo;</li>
        
      <li>Miniconda in Dalma</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="miniconda-in-dalma">
<span id="miniconda"></span><h1>Miniconda in Dalma<a class="headerlink" href="#miniconda-in-dalma" title="Permalink to this headline">¶</a></h1>
<p>We have a centralized installation of Miniconda in Dalma. The users can either
install their own Miniconda or use the centralized installation present in Dalma. This centralized installation can also be used for creating your own local environments, wherein you can install your own packages. Moreover, You can clone the existing centralized environments (like Tensorflow, R) and add other required libraries or packages on top of it.</p>
<p>The conda cheat sheet gives you a list of useful commands in a glance:  <a class="reference external" href="https://docs.conda.io/projects/conda/en/4.6.0/_downloads/52a95608c49671267e40c689e0bc00ca/conda-cheatsheet.pdf">Conda-cheat-sheet</a></p>
<section id="one-time-set-up">
<h2>One Time Set up<a class="headerlink" href="#one-time-set-up" title="Permalink to this headline">¶</a></h2>
<p>Execute the following command for making Dalma Miniconda as your default conda environment. This is needed to be done <strong>ONLY once</strong>, just for setting up Miniconda for your account. Loading the miniconda module sets the miniconda environement for your account. You also need to source the bashrc file to activate the changes in your current shell. Once the environment is set up, you donot need to load the miniconda again in your subsequent logins.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load miniconda
<span class="nb">source</span> ~/.bashrc
</pre></div>
</div>
</section>
<section id="managing-environments">
<span id="managing-envs"></span><h2>Managing Environments<a class="headerlink" href="#managing-environments" title="Permalink to this headline">¶</a></h2>
<p><strong>Create a Local Environment</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#conda create -n &lt;name of the environment&gt;</span>

<span class="c1">#or</span>

<span class="c1">#conda create -p /scratch/&lt;NetID&gt;/conda-envs/R --clone R-3.6</span>

<span class="c1">#example:</span>
conda create -n myenv1
</pre></div>
</div>
<p><strong>Activate the Local Environment</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#conda activate &lt;path to local env&gt;</span>

<span class="c1">#or</span>

<span class="c1">#conda activate &lt;name of the environment&gt;</span>
<span class="c1">#example:</span>
conda activate myenv1
</pre></div>
</div>
<p><strong>Deactivate an Environment</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda deactivate
</pre></div>
</div>
<p><strong>Listing the Environments Available</strong></p>
<p>This shows the existing local and centralized Miniconda environments available</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda env list
</pre></div>
</div>
<p>A sample output is shown below. The list of centralized and local installations can be seen.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>                                     /home/wz22/.conda/envs/myenv
                                     /home/wz22/.conda/envs/myenv2
                                     /home/wz22/.conda/envs/myenv3
                                     /home/wz22/.conda/envs/myenv4
base                            *    /share/apps/NYUAD/miniconda/3-4.8.2
firefox                              /share/apps/NYUAD/miniconda/3-4.8.2/envs/firefox
tensorflow-1.15                      /share/apps/NYUAD/miniconda/3-4.8.2/envs/tensorflow-1.15
tensorflow-2.0                       /share/apps/NYUAD/miniconda/3-4.8.2/envs/tensorflow-2.0
</pre></div>
</div>
<p><strong>Cloning an Environment</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#conda create -p &lt;path to new env&gt; --clone &lt;path to existing env&gt;</span>
<span class="c1">#example: Here we clone the existing Tensorflow environment.</span>
conda create -n tf-gpu --clone tensorflow-1.15
</pre></div>
</div>
</section>
<section id="migrating-sharing-environment">
<h2>Migrating / Sharing Environment<a class="headerlink" href="#migrating-sharing-environment" title="Permalink to this headline">¶</a></h2>
<p>It is possible to migrate an environment, with exact same packages and configuration.
This is the beauty of Conda. Same environment, anywhere.</p>
<ol class="arabic">
<li><dl>
<dt>Activate the environment you want to migrate from.</dt><dd><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Activate the environment you want to migrate from</span>
<span class="c1"># Example: conda activate &lt;env-migrate-from&gt;</span>
conda activate myenv
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Export the environment to an yml file.</dt><dd><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># In this example, the yml file is called environment.yml</span>
conda env <span class="nb">export</span> &gt; environment.yml
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Share this yml file.</dt><dd><p>The other person / machine, an identical environment could be created using this yml file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># In this example, the yml file is called environment.yml</span>
conda env create -f environment.yml
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</section>
<section id="submitting-job-scripts">
<h2>Submitting Job Scripts<a class="headerlink" href="#submitting-job-scripts" title="Permalink to this headline">¶</a></h2>
<p>The conda environment might not get activated when submitting a Job script since the slurm doesn’t source the <code class="docutils literal notranslate"><span class="pre">bashrc</span></code> file. Hence, in order to go about this, you can include the following line in your job submission script before activating the required environment.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> ~/.bashrc
</pre></div>
</div>
<p>A sample job submission script is shown below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH -n 10</span>
<span class="c1">#SBATCH -t 48:00:00</span>
<span class="c1">#Other SBATCH commands go here</span>

<span class="c1">#Activating conda</span>
<span class="nb">source</span> ~/.bashrc
conda activate myenv1

<span class="c1">#Your appication commands go here</span>
python abc.py
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In order to avoid activating a long path everytime, an alias can be created in the bashrc similar to the following</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">alias</span> <span class="nv">myenv1</span><span class="o">=</span><span class="s1">&#39;conda activate myenv1&#39;</span>
</pre></div>
</div>
<p>This will activate the environment just by typing <code class="docutils literal notranslate"><span class="pre">myenv1</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Go through the Conda 30 mins test drive to make sure you understand the basic concepts: <a class="reference external" href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html</a></p>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dalma_pytorch.html" class="btn btn-neutral float-right" title="PyTorch in Dalma" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="dalma_jupyter.html" class="btn btn-neutral float-left" title="Jupyter Notebook in Dalma" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Center for Research Computing | NYU Abu Dhabi.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>