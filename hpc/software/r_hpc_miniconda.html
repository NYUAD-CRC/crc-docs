

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>R in HPC Miniconda &mdash; CRC Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Connecting VS Code to HPC using SSH" href="vscode.html" />
    <link rel="prev" title="Singularity Overlays" href="singularity_overlays.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/crc-wordmark-light.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">HPC Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../hpc.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../old_hpc.html">Previous HPC Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounts/index.html">Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system/index.html">System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../storage/index.html">Storage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#software-modules-and-environment">Software Modules and environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hpc-miniconda">HPC Miniconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#matlab">Matlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#singularity">Singularity</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#miscellaneous">Miscellaneous</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">R in HPC Miniconda</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-to-clone-the-r-environment">How to clone the R environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#finding-the-conda-complementary-packages-tidyverse-rstan-etc">Finding the Conda complementary packages (Tidyverse, Rstan etc)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-install-the-conda-complementary-packages">How to install the Conda complementary packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submitting-job-scripts">Submitting Job Scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="vscode.html">Connecting VS Code to HPC using SSH</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jobs/index.html">Jobs Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ood/index.html">HPC Web Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../research/index.html">Research Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help/index.html">Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/index.html">HPC Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc_load/index.html">HPC Load</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RCS Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rcs/rcs.html">Research Computing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rcs/1001n.html">1001n Research Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rcs/kb/index.html">Knowledge Base</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Science</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data_science/data_science.html">Research Data Science Services</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Team</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../team.html">Center for Research Computing Team</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CRC Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Software</a> &raquo;</li>
        
      <li>R in HPC Miniconda</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="r-in-hpc-miniconda">
<h1>R in HPC Miniconda<a class="headerlink" href="#r-in-hpc-miniconda" title="Permalink to this heading">¶</a></h1>
<p>Apart from a centralized installation of R, we also have a Miniconda installation of R (ver=3.6) as part of the Miniconda module in the HPC. This provides greater flexibility and
easier installation for other complementary packages required for R (eg: Tidyverse, Rstan etc).
To find more details on the Miniconda module usage, click <a class="reference internal" href="hpc_miniconda.html"><span class="doc">here</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you have never used Conda, we recommend you to use the HPC Miniconda.
You can find the steps to set up the HPC Miniconda by clicking <a class="reference internal" href="hpc_miniconda.html"><span class="doc">here</span></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The conda cheat sheet gives you a list of useful commands in a glance:  <a class="reference external" href="https://docs.conda.io/projects/conda/en/4.6.0/_downloads/52a95608c49671267e40c689e0bc00ca/conda-cheatsheet.pdf">Conda-cheat-sheet</a></p>
</div>
<div class="section" id="how-to-clone-the-r-environment">
<h2>How to clone the R environment<a class="headerlink" href="#how-to-clone-the-r-environment" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><dl>
<dt>If you are using the HPC Miniconda</dt><dd><p>This creates an exclusive local environment (installation) of the R package in the given path (in the example below, the path is “/scratch/wz22/my-envs/R”). The User can now activate this environment and use it and further install any required complementary packages in the activated environment (More details on this in upcoming sections).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#conda create -p /scratch/&lt;NetID&gt;/conda-envs/R --clone R-3.6</span>

<span class="c1">#or</span>

<span class="c1">#conda create -n &lt;name of the new env&gt; --clone &lt;existing env&gt;</span>

<span class="c1">#example:</span>
conda<span class="w"> </span>create<span class="w"> </span>-p<span class="w"> </span>/scratch/wz22/conda-envs/R<span class="w"> </span>--clone<span class="w"> </span>R-3.6

<span class="c1">#or</span>

conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>R<span class="w"> </span>--clone<span class="w"> </span>R-3.6
</pre></div>
</div>
<p>A sample output is shown below:</p>
<img alt="../../_images/R1.png" src="../../_images/R1.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It must be noted that the given path is not the path to the working directory, but the location where the user wishes to install the environment. The user can navigate to any directory (where his application and running script resides) and activate the required environment.</p>
</div>
</dd>
</dl>
</li>
<li><p>If you are using your own conda package</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#conda create -p /scratch/&lt;NetID&gt;/conda-envs/R --clone &lt;path-to-existing-env&gt;</span>

<span class="c1">#or</span>

<span class="c1">#conda create -n &lt;name of the new env&gt; --clone &lt;path to existing env&gt;</span>

<span class="c1">#example:</span>

conda<span class="w"> </span>create<span class="w"> </span>-p<span class="w"> </span>/scratch/wz22/conda-envs/R<span class="w"> </span>--clone<span class="w"> </span>/share/apps/NYUAD/miniconda/3-4.8.2/envs/R-3.6

<span class="c1">#or</span>

conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>R<span class="w"> </span>--clone<span class="w"> </span>/share/apps/NYUAD/miniconda/3-4.8.2/envs/R-3.6
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="finding-the-conda-complementary-packages-tidyverse-rstan-etc">
<h2>Finding the Conda complementary packages (Tidyverse, Rstan etc)<a class="headerlink" href="#finding-the-conda-complementary-packages-tidyverse-rstan-etc" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><dl class="simple">
<dt>Search on the web for the Conda package of the required library.</dt><dd><p>For instance, if the required library is Tidyverse, you can search for “conda install r tidyverse”. You can then navigate to the link with anaconda (most probably the first one, like here).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Find the installation command from the anaconda link</dt><dd><p>The page should look something like this :</p>
<img alt="../../_images/R2.png" src="../../_images/R2.png" />
<p>The command highlighted in red box is the command for installing the required package.</p>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="how-to-install-the-conda-complementary-packages">
<h2>How to install the Conda complementary packages<a class="headerlink" href="#how-to-install-the-conda-complementary-packages" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><dl>
<dt>Activate the local R environment</dt><dd><p>you can find more about managing environments, by clicking <a class="reference internal" href="hpc_miniconda.html#managing-envs"><span class="std std-ref">here</span></a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#conda activate &lt;path to local env&gt;</span>

<span class="c1">#or</span>

<span class="c1">#conda activate &lt;name of the environment&gt;</span>
<span class="c1">#example:</span>
conda<span class="w"> </span>activate<span class="w"> </span>R
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Install the required package</dt><dd><p>Paste the installation command found on the Anaconda web page as described above. Enter <code class="docutils literal notranslate"><span class="pre">y</span></code> when it prompts for confirmation.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#example:</span>
conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>r<span class="w"> </span>r-tidyverse
</pre></div>
</div>
<p>A sample output is shown below:</p>
<img alt="../../_images/R3.png" src="../../_images/R3.png" />
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It must be noted that the complementary packages must be installed only after activating the local R environment.</p>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Once the installation is done, launch R and check the installation of the package using the “library( )” function of R.</dt><dd><p>A sample output is shown below:
.. image:: ../img/R4.png</p>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="submitting-job-scripts">
<h2>Submitting Job Scripts<a class="headerlink" href="#submitting-job-scripts" title="Permalink to this heading">¶</a></h2>
<p>The conda environment might not get activated when submitting a Job script since the slurm doesn’t source the bashrc file. Hence, in order to go about this, you can include the following line in your job submission script before activating the required environment.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>~/.bashrc
</pre></div>
</div>
<p>A sample job submission script is shown below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH -n 10</span>
<span class="c1">#SBATCH -t 48:00:00</span>
<span class="c1">#Other SBATCH commands go here</span>

<span class="c1">#Activating conda</span>
<span class="nb">source</span><span class="w"> </span>~/.bashrc
conda<span class="w"> </span>activate<span class="w"> </span>R

<span class="c1">#Your appication commands go here</span>
Rscript<span class="w"> </span>abc.R
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Go through the Conda 30 mins test drive to make sure you understand the basic concepts:  <a class="reference external" href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="vscode.html" class="btn btn-neutral float-right" title="Connecting VS Code to HPC using SSH" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="singularity_overlays.html" class="btn btn-neutral float-left" title="Singularity Overlays" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Center for Research Computing | NYU Abu Dhabi.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>