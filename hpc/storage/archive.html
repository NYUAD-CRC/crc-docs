

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>$ARCHIVE &mdash; CRC Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Data Sharing with Collaborators" href="data_sharing.html" />
    <link rel="prev" title="Mount $WORK with SSHFS" href="mount_work.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/crc-wordmark-light.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">HPC Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../hpc.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dalma.html">Dalma HPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounts/index.html">Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system/index.html">System</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Storage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="home_scratch.html">$HOME and $SCRATCH</a></li>
<li class="toctree-l2"><a class="reference internal" href="work.html">$WORK</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">$ARCHIVE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quick-glance-into-the-archive-commands">Quick Glance into the archive commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#archive-sh">archive.sh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data_sharing.html">Data Sharing with Collaborators</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#know-your-quota">Know Your Quota</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../software/index.html">Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jobs/index.html">Jobs Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ood/index.html">HPC Web Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../research/index.html">Research Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help/index.html">Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/index.html">HPC Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc_load/index.html">HPC Load</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RCS Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rcs/rcs.html">Research Computing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rcs/1001n.html">1001n Research Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rcs/kb/index.html">Knowledge Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rcs/data_science/index.html">Research Data Science Services</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Team</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../team.html">Center for Research Computing Team</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CRC Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Storage</a> &raquo;</li>
        
      <li>$ARCHIVE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="archive">
<h1>$ARCHIVE<a class="headerlink" href="#archive" title="Permalink to this heading">¶</a></h1>
<p>When storage is shared among many users rules must be set to prevent users to consume disk space
excessively at the expense of others. For this purpose HPC systems enforce disk quotas to users and
groups of users. The regular cleanup of the <code class="docutils literal notranslate"><span class="pre">/scratch</span></code> storage is essential to maintain its efficiency
and easily manage the capacity.
The current policy is to remove any files(data) that have not been accessed (viewed, created or modified)
for more than 90 days.</p>
<p>On the HPC disk quotas are enforced on <code class="docutils literal notranslate"><span class="pre">/home</span></code> and <code class="docutils literal notranslate"><span class="pre">/scratch</span></code> (not <code class="docutils literal notranslate"><span class="pre">/archive</span></code> ). There are two
quota constraints: the total amount of disk space and the total number of files. Once you reach a quota
limit your jobs may be killed. So it is a good practice to check your quota before submitting a job that
will generate a lot of data.</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">myquota</span></code> command in the terminal on the HPC to check your current usage and quota. Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                    <span class="n">DISK</span> <span class="n">SPACE</span>                <span class="c1"># FILES (1000&#39;s)</span>
<span class="n">filesystem</span>       <span class="n">size</span>      <span class="n">quota</span>            <span class="n">number</span>      <span class="n">quota</span>
            <span class="o">--------------------------</span>   <span class="o">--------------------------</span>
<span class="o">/</span><span class="n">home</span>         <span class="mi">131</span><span class="n">KB</span>     <span class="mi">6442</span><span class="n">MB</span> <span class="p">(</span> <span class="mi">0</span><span class="o">%</span><span class="p">)</span>           <span class="mi">0</span>        <span class="mi">100</span> <span class="p">(</span> <span class="mi">0</span><span class="o">%</span><span class="p">)</span>
<span class="o">/</span><span class="n">scratch</span>      <span class="mi">220</span><span class="n">GB</span>     <span class="mi">5242</span><span class="n">GB</span> <span class="p">(</span> <span class="mi">4</span><span class="o">%</span><span class="p">)</span>           <span class="mi">4</span>        <span class="mi">500</span> <span class="p">(</span> <span class="mi">1</span><span class="o">%</span><span class="p">)</span>
<span class="o">/</span><span class="n">work</span>         <span class="mi">4</span><span class="n">KB</span>       <span class="mi">5242</span><span class="n">GB</span> <span class="p">(</span> <span class="mi">0</span><span class="o">%</span><span class="p">)</span>           <span class="mi">0</span>        <span class="mi">512</span> <span class="p">(</span> <span class="mi">0</span><span class="o">%</span><span class="p">)</span>
<span class="o">/</span><span class="n">archive</span>      <span class="mi">418</span><span class="n">GB</span>     <span class="mi">5242</span><span class="n">GB</span> <span class="p">(</span> <span class="mi">8</span><span class="o">%</span><span class="p">)</span>           <span class="mi">3</span>        <span class="mi">125</span> <span class="p">(</span> <span class="mi">3</span><span class="o">%</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="quick-glance-into-the-archive-commands">
<h2>Quick Glance into the archive commands<a class="headerlink" href="#quick-glance-into-the-archive-commands" title="Permalink to this heading">¶</a></h2>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Action</p></th>
<th class="head"><p>Command</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>List the Files</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dmfls</span> <span class="pre">&lt;path-to-archive&gt;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dmfls</span> <span class="pre">/archive/wz22</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Copy to Archive</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dmfput</span> <span class="pre">&lt;full-path-to-scracth&gt;</span> <span class="pre">&lt;full-path-to-archive&gt;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dmfput</span> <span class="pre">/scratch/wz22/abc/def</span> <span class="pre">/archive/wz22/.</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Retrieve from Archive</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dmfget</span> <span class="pre">&lt;full-path-to-archive&gt;</span> <span class="pre">&lt;full-path-to-scratch&gt;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dmfget</span> <span class="pre">/archive/wz22/def</span> <span class="pre">/scratch/wz22/abc/.</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Delete from archive</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dmfrm</span> <span class="pre">-r</span> <span class="pre">&lt;full-path-to-archive-dir&gt;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dmfrm</span> <span class="pre">-r</span> <span class="pre">/archive/wz22/def</span></code></p></td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The guide to long term storage (archive) can be downloaded from here: <a class="reference download internal" download="" href="../../_downloads/b61f6830f1758c147bb8a6e50165c14b/Dalma-Storage.pdf"><code class="xref download docutils literal notranslate"><span class="pre">Archive</span> <span class="pre">Storage</span></code></a></p>
</div>
</div>
<div class="section" id="archive-sh">
<h2>archive.sh<a class="headerlink" href="#archive-sh" title="Permalink to this heading">¶</a></h2>
<p>We also have a script <code class="docutils literal notranslate"><span class="pre">archive.sh</span></code> which facilitates this process. The <code class="docutils literal notranslate"><span class="pre">archive.sh</span></code> takes one argumnet in the form
of the path of the directory to be archived.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">archive.sh</span></code> does the follwoing:</p>
<ol class="arabic simple">
<li><p>Create a tar with the same name and the date appended.</p></li>
<li><p>Archive the tar using dmfput.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#USAGE:</span>
<span class="c1">#archive.sh &lt;Path-to-dir-to-be-archived&gt;</span>

<span class="c1">#example</span>
archive.sh /scratch/wz22/abc/def
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>This will create a tar in the directory <code class="docutils literal notranslate"><span class="pre">/scratch/wz22/abc</span></code> with the name <code class="docutils literal notranslate"><span class="pre">def-ddmmyyyy.tar.gz</span></code> where</dt><dd><p><code class="docutils literal notranslate"><span class="pre">ddmmyyyy</span></code> corresponds to date the script <code class="docutils literal notranslate"><span class="pre">archive.sh</span></code> was invoked.</p>
</dd>
</dl>
</li>
<li><p>Once the tar creation is done, the tar is archived using <code class="docutils literal notranslate"><span class="pre">dmpfput</span></code></p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you have a larger directory to be archived, you could use <code class="docutils literal notranslate"><span class="pre">screen</span></code> sessions to run the
script in background. An example is given below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load screen
screen -dm bash -c <span class="s2">&quot;archive.sh /scratch/wz22/abc/def 2&gt;&amp;1 | tee archive.log&quot;</span>
</pre></div>
</div>
<p>The above command will initiate the <code class="docutils literal notranslate"><span class="pre">archive.sh</span></code> in a screen session which shall run in the
background. It will also write the output to a file named <code class="docutils literal notranslate"><span class="pre">archived.log</span></code>.</p>
<p>You could learn more about the <code class="docutils literal notranslate"><span class="pre">screen</span></code> commands using the link <a class="reference external" href="https://www.geeksforgeeks.org/screen-command-in-linux-with-examples/">here</a>
or using the command below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>screen -h
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use the following command to list the contents of the folder not accessed for “N” number of days.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#lfs find &lt;path-to-folder&gt; --atime +&lt;number-of-days&gt; --type f</span>

<span class="c1">#example:</span>
lfs find /scratch/wz22/abc --atime +250 --type f
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The archiving (<code class="docutils literal notranslate"><span class="pre">dmfput</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">dmfget</span></code>) might take some time for larger files. Hence It is
advisable to use <code class="docutils literal notranslate"><span class="pre">screen</span></code> sessions to run the same in the background.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="data_sharing.html" class="btn btn-neutral float-right" title="Data Sharing with Collaborators" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mount_work.html" class="btn btn-neutral float-left" title="Mount $WORK with SSHFS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Center for Research Computing | NYU Abu Dhabi.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>